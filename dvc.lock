schema: '2.0'
stages:
  fetch_data:
    cmd: python src_versioning/data_preprocess.py --output data/raw/gold_snapshot_latest.csv
    deps:
    - path: src_versioning/data_preprocess.py
      hash: md5
      md5: 304702aa063c0c125239b86ac7c490c6
      size: 3721
    outs:
    - path: data/raw/gold_snapshot_latest.csv
      hash: md5
      md5: f3d396c34e698b1b316853944a7d39c8
      size: 124524
  train_model:
    cmd: python src_versioning/train_model.py --input data/raw/gold_snapshot_latest.csv
      --output models/gold_lstm_model.pkl
    deps:
    - path: data/raw/gold_snapshot_latest.csv
      hash: md5
      md5: f3d396c34e698b1b316853944a7d39c8
      size: 124524
    - path: src_versioning/train_model.py
      hash: md5
      md5: 4f40d00cab42c92e0baa29cd71c81d24
      size: 3991
    outs:
    - path: models/gold_lstm_model.pkl
      hash: md5
      md5: d449b2777e5300bfed7e166844b1a322
      size: 424797
  update_metadata:
    cmd: python src_versioning/metadata_updater.py
    deps:
    - path: models/gold_lstm_model.pkl
      hash: md5
      md5: d449b2777e5300bfed7e166844b1a322
      size: 424797
    - path: src_versioning/metadata_updater.py
      hash: md5
      md5: 9973347bc1e4debf2c00fa79f7d46a1f
      size: 1059
    outs:
    - path: models/model_metadata.json
      hash: md5
      md5: 875862c9162ce0188c3d2a9adb6c4101
      size: 81
  validate_data:
    cmd: great_expectations checkpoint run gold_prices_checkpoint1
    deps:
    - path: data/raw/gold_snapshot_latest.csv
      hash: md5
      md5: f3d396c34e698b1b316853944a7d39c8
      size: 124524
    - path: great_expectations/checkpoints/gold_prices_checkpoint1.yml
      hash: md5
      md5: f9314240ffebb93977cd277dac040a2f
      size: 826
    - path: great_expectations/expectations/Gold_Prices_Suite.json
      hash: md5
      md5: 1adc0557ab11020bd3b005926580bd4a
      size: 3651
    outs:
    - path: great_expectations/uncommitted/data_docs/local_site/
      hash: md5
      md5: 87130d57541ed6bb6241cee42952a2da.dir
      size: 4202340
      nfiles: 23
    - path: great_expectations/uncommitted/validations/
      hash: md5
      md5: 675fe34ed3d75d5f558ea1a4f8f5b60c.dir
      size: 11003
      nfiles: 2
  drift_detection:
    cmd: python src_versioning/drift_detector.py --reference data/reporting_data/base_data.parquet
      --current data/raw/gold_snapshot_latest.csv --out data/reporting_data/drift_report.html
    deps:
    - path: data/raw/gold_snapshot_latest.csv
      hash: md5
      md5: f3d396c34e698b1b316853944a7d39c8
      size: 124524
    - path: data/reporting_data/base_data.parquet
      hash: md5
      md5: 97a2ec09e753386e3a5608bc6a2d3aab
      size: 56203
    - path: src_versioning/drift_detector.py
      hash: md5
      md5: 35f5e4c51af28d8551115cb735ee6ac3
      size: 3668
    outs:
    - path: data/reporting_data/drift_full_report.html
      hash: md5
      md5: 2e6a4b942a403759b476d13a2773cdb0
      size: 3019732
    - path: data/reporting_data/drift_test_suite_report.html
      hash: md5
      md5: 3292f99276484b87ab131982e7635df1
      size: 2831407
